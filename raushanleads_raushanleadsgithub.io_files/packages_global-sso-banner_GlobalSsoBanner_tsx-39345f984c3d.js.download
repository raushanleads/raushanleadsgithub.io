"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["packages_global-sso-banner_GlobalSsoBanner_tsx"],{16070:(e,n,t)=>{t.d(n,{Y0:()=>G,$I:()=>A,kR:()=>R});var i=t(74848),r=t(96540),s=t(97949),l=t(38621),a=t(88934),o=t(31315),c=t(69599),d=t(51587),u=t(11083),m=t(30459),h=t(79634);let g={bannerOuterWrapper:"GlobalSSOBanner-module__bannerOuterWrapper--fyxDF",bannerInnerWrapper:"GlobalSSOBanner-module__bannerInnerWrapper--butqf",banner:"GlobalSSOBanner-module__banner--kzCnx",dismissedOrgList:"GlobalSSOBanner-module__dismissedOrgList--Jkrx7",durationSelector:"GlobalSSOBanner-module__durationSelector--DOJjX"};function p({children:e,hidden:n}){let[t,s]=r.useState("visible"),l=r.useRef(null),a=r.useRef(void 0);return(r.useEffect(()=>{if(n&&"visible"===t){s("collapsing");let e=l.current;if(e){let n=e.getBoundingClientRect().height;a.current=n,e.style.height=`${n}px`}}else if("collapsing"===t){let e=setTimeout(()=>{s("hidden")},300);return()=>{clearTimeout(e)}}},[n,t]),"hidden"===t)?null:(0,i.jsx)("div",{ref:l,style:{height:"visible"===t?a.current??"auto":0},className:g.bannerOuterWrapper,children:(0,i.jsx)("div",{className:g.bannerInnerWrapper,style:{transform:"visible"===t?void 0:`translateY(-${a.current??0}px)`},children:e})})}try{300..displayName||(300..displayName="ANIMATION_DURATION")}catch{}try{p.displayName||(p.displayName="SlideDismiss")}catch{}var b=t(21728),_=t(57352),f=t(15220);function y(e){let n,t,r,s=(0,b.c)(7),{ssoOrgs:l}=e;if(1===l.length){let e,n=l[0],t=n?.name;return s[0]!==t?(e=(0,i.jsxs)("p",{children:["You are dismissing single sign-on prompts for the ",t," organization on this device."]}),s[0]=t,s[1]=e):e=s[1],e}return s[2]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)("p",{children:"You are dismissing single sign-on prompts for the following organizations on this device:"}),s[2]=n):n=s[2],s[3]!==l?(t=l.map(x),s[3]=l,s[4]=t):t=s[4],s[5]!==t?(r=(0,i.jsxs)(i.Fragment,{children:[n,(0,i.jsx)("ul",{className:g.dismissedOrgList,children:t})]}),s[5]=t,s[6]=r):r=s[6],r}function x(e){return(0,i.jsx)("li",{children:e.name},e.id)}try{y.displayName||(y.displayName="DismissalSummary")}catch{}var S=t(27042),j=t(5524),O=t(46251);let v=30,N=[{id:"one-day",text:"One day",days:1},{id:"one-week",text:"One week",days:7},{id:"one-month",text:"One month",days:v},{id:"one-year",text:"One year",days:365}],$=()=>N.findIndex(e=>e.days===v);function k(e){let n,t,r,s,a,o=(0,b.c)(11),{selectedDurationIndex:c,onDurationChange:d}=e,u=N[c];o[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)("span",{id:"dismissal-duration-label",children:"Remind me again in"}),o[0]=n):n=o[0];let m=u?.text||"Pick duration";return o[1]!==m?(t=(0,i.jsx)(S.W.Button,{trailingAction:l.TriangleDownIcon,"aria-labelledby":"dismissal-duration-label",children:m}),o[1]=m,o[2]=t):t=o[2],o[3]!==d||o[4]!==c?(r=N.map((e,n)=>(0,i.jsx)(j.l.Item,{role:"menuitemradio",selected:n===c,"aria-checked":n===c,onSelect:()=>d(n),children:e.text},e.id)),o[3]=d,o[4]=c,o[5]=r):r=o[5],o[6]!==r?(s=(0,i.jsx)(S.W.Overlay,{children:(0,i.jsx)(j.l,{selectionVariant:"single",role:"menu","aria-labelledby":"dismissal-duration-label",children:r})}),o[6]=r,o[7]=s):s=o[7],o[8]!==t||o[9]!==s?(a=(0,i.jsxs)(O.B,{align:"center",direction:"horizontal",className:g.durationSelector,children:[n,(0,i.jsxs)(S.W,{children:[t,s]})]}),o[8]=t,o[9]=s,o[10]=a):a=o[10],a}try{k.displayName||(k.displayName="DurationMenu")}catch{}function C(e){let n,t,s,l,a,o,c,d,u,m,h=(0,b.c)(23),{isOpen:g,onClose:p,onConfirm:x,ssoOrgs:S}=e,[j,O]=r.useState($);h[0]!==g?(n=()=>{g&&O($())},t=[g],h[0]=g,h[1]=n,h[2]=t):(n=h[1],t=h[2]),r.useEffect(n,t),h[3]!==x||h[4]!==j?(s=()=>{let e=N[j];x(e?.days??v)},h[3]=x,h[4]=j,h[5]=s):s=h[5];let C=s;return g?(h[6]!==p?(l={buttonType:"default",content:"Cancel",onClick:p},h[6]=p,h[7]=l):l=h[7],h[8]!==C?(a={buttonType:"primary",content:"Confirm",onClick:C},h[8]=C,h[9]=a):a=h[9],h[10]!==l||h[11]!==a?(o=[l,a],h[10]=l,h[11]=a,h[12]=o):o=h[12],h[13]!==S?(c=(0,i.jsx)(y,{ssoOrgs:S}),h[13]=S,h[14]=c):c=h[14],h[15]!==j?(d=(0,i.jsx)(k,{selectedDurationIndex:j,onDurationChange:O}),h[15]=j,h[16]=d):d=h[16],h[17]===Symbol.for("react.memo_cache_sentinel")?(u=(0,i.jsxs)("p",{children:["To sign into any of your SSO organizations, visit the"," ",(0,i.jsx)(_.A,{href:"/settings/organizations",inline:!0,children:"SSO settings page."})]}),h[17]=u):u=h[17],h[18]!==p||h[19]!==o||h[20]!==c||h[21]!==d?(m=(0,i.jsxs)(f.l,{title:"Dismiss SSO Banner",width:"medium",height:"auto",onClose:p,footerButtons:o,children:[c,d,u]}),h[18]=p,h[19]=o,h[20]=c,h[21]=d,h[22]=m):m=h[22],m):null}try{C.displayName||(C.displayName="ConfirmationDialog")}catch{}var z=t(21373),D=t(77430),w=t(79988);function B(e,n){let t=`/orgs/${encodeURIComponent(e)}/sso`,i=n.pathname+n.search+n.hash;return`${t}?return_to=${encodeURIComponent(i)}`}function I(e){let n,t,r,s,l,a=(0,b.c)(20),{ssoOrgs:o,redirectLocation:c}=e,{sendClickAnalyticsEvent:d}=(0,m.S)();if(0===o.length)return null;a[0]!==d?(n=()=>{d({category:w.c$,action:"click_single_sso_button",label:"sso_authentication"})},a[0]=d,a[1]=n):n=a[1];let u=n;a[2]!==d?(t=e=>{d({category:w.c$,action:"click_sso_dropdown_item",label:`org:${e}`})},a[2]=d,a[3]=t):t=a[3];let h=t;if(1===o.length){let e,n,t=o[0];return void 0===t?null:(a[4]!==t.login||a[5]!==c?(e=B(t.login,c),a[4]=t.login,a[5]=c,a[6]=e):e=a[6],a[7]!==u||a[8]!==e?(n=(0,i.jsx)(z.Q,{as:"a",href:e,onClick:u,children:"Single sign-on"}),a[7]=u,a[8]=e,a[9]=n):n=a[9],n)}if(a[10]===Symbol.for("react.memo_cache_sentinel")?(r=(0,i.jsx)(S.W.Button,{size:"small",children:"Single sign-on"}),a[10]=r):r=a[10],a[11]!==h||a[12]!==c||a[13]!==o){let e;a[15]!==h||a[16]!==c?(e=e=>(0,i.jsxs)(j.l.LinkItem,{href:B(e.login,c),onClick:()=>h(e.name),children:[e.avatar_url&&(0,i.jsx)(j.l.LeadingVisual,{children:(0,i.jsx)(D.r,{size:24,src:e.avatar_url})}),e.name]},e.login),a[15]=h,a[16]=c,a[17]=e):e=a[17],s=o.map(e),a[11]=h,a[12]=c,a[13]=o,a[14]=s}else s=a[14];return a[18]!==s?(l=(0,i.jsxs)(S.W,{children:[r,(0,i.jsx)(S.W.Overlay,{children:(0,i.jsx)(j.l,{children:s})})]}),a[18]=s,a[19]=l):l=a[19],l}try{I.displayName||(I.displayName="SSOActionMenu")}catch{}function T(){let e=(0,o.Ri)(w.z4);if(e?.value)try{let n=JSON.parse(e.value);return Array.isArray(n)?n:[]}catch(e){(0,o.Yj)(w.z4)}return[]}function W(e){return"object"==typeof e&&null!==e&&"id"in e&&"name"in e&&"login"in e}function A({ssoOrgs:e}){let n=(0,a.zy)(),[t,d]=r.useState("visible"),[h,b]=r.useState(!1),_=r.useRef(!1),{sendClickAnalyticsEvent:f}=(0,m.S)(),y=(0,c.G7)("global_sso_banner_dismiss_dialog");if(r.useEffect(()=>{!_.current&&e.length>0&&((0,c.G7)("record_sso_banner_metrics")&&(0,u.i)({incrementKey:"GLOBAL_SSO_BANNER_DISPLAYED",requestUrl:window.location.href}),_.current=!0)},[e]),0===e.length)return null;let x=(n=v)=>{d("hidden");let t=e.map(e=>e.id);(0,c.G7)("global_sso_banner_dismiss_dialog")&&(t=[...new Set([...T(),...t])].sort()),(0,o.Yj)(w.z4);let i=n??v,r=new Date(Date.now()+24*i*36e5).toUTCString();(0,o.TV)(w.z4,JSON.stringify(t),r)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p,{hidden:"visible"!==t,children:(0,i.jsx)(s.l,{title:"Single-sign on",className:g.banner,hideTitle:!0,icon:(0,i.jsx)(l.ShieldLockIcon,{}),description:(()=>{if(0===e.length)return"Single sign-on to see results";let n=e.slice(0,w.n5),t=e.length-w.n5,r=1===e.length?"organization":"organizations";return(0,i.jsxs)(i.Fragment,{children:["Single sign-on to see results in the ",(()=>{let e=n.map(e=>(0,i.jsx)("strong",{children:e.name},e.login));if(1===e.length)return e[0];{if(2===e.length)return(0,i.jsxs)(i.Fragment,{children:[e[0]," and ",e[1]]});let n=e.length-1,r=(0,i.jsxs)(i.Fragment,{children:[e[0],", ",e[1],", and ",e[n]]});return t>0?(0,i.jsxs)(i.Fragment,{children:[r,", and ",t," more"]}):r}})()," ",r]})})(),onDismiss:()=>{f({category:w.c$,action:"click_dismiss_button",label:"banner_dismissed"}),y?b(!0):x()},primaryAction:(0,i.jsx)(I,{ssoOrgs:e,redirectLocation:n}),"data-testid":"global-sso-banner"})}),(0,i.jsx)(C,{isOpen:y&&h,onClose:()=>b(!1),onConfirm:e=>{x(e),b(!1)},ssoOrgs:e})]})}function G(){let{ssoOrgs:e,suppressBanner:n}=function(){let{ssoOrgs:e,baseAvatarUrl:n}=(0,d.N)(),{current_sso_orgs_match_dismissed_cookie:t}=(0,h.X)()??{},i=r.useMemo(()=>e.filter(W).map(e=>({...e,avatar_url:`${n}/u/${e.id}`})),[e,n]);return{suppressBanner:!0===t||function(e){let n=T();return e.length===n.length&&e.every(e=>n.includes(e.id))}(i),ssoOrgs:i,baseAvatarUrl:n}}();return 0===e.length||!(0,c.G7)("global_sso_banner")||n?null:(0,i.jsx)(A,{ssoOrgs:e})}let R=w.z4;try{A.displayName||(A.displayName="GlobalSsoBanner")}catch{}try{G.displayName||(G.displayName="ContextualGlobalSsoBanner")}catch{}},31315:(e,n,t)=>{function i(e){return r(e)[0]}function r(e){let n=[];for(let t of function(){try{return document.cookie.split(";")}catch{return[]}}()){let[i,r]=t.trim().split("=");e===i&&void 0!==r&&n.push({key:i,value:r})}return n}function s(e,n,t=null,i=!1,r="lax"){let l=document.domain;if(null==l)throw Error("Unable to get document domain");l.endsWith(".github.com")&&(l="github.com");let a="https:"===location.protocol?"; secure":"",o=t?`; expires=${t}`:"";!1===i&&(l=`.${l}`);try{document.cookie=`${e}=${n}; path=/; domain=${l}${o}${a}; samesite=${r}`}catch{}}function l(e,n=!1){let t=document.domain;if(null==t)throw Error("Unable to get document domain");t.endsWith(".github.com")&&(t="github.com");let i=new Date(Date.now()-1).toUTCString(),r="https:"===location.protocol?"; secure":"",s=`; expires=${i}`;!1===n&&(t=`.${t}`);try{document.cookie=`${e}=''; path=/; domain=${t}${s}${r}`}catch{}}t.d(n,{OR:()=>r,Ri:()=>i,TV:()=>s,Yj:()=>l})},51587:(e,n,t)=>{t.d(n,{N:()=>s});var i=t(79634),r=t(96540);let s=()=>{let e=(0,i.X)();return(0,r.useMemo)(()=>({ssoOrgs:e?.sso_organizations??[],baseAvatarUrl:e?.base_avatar_url??"https://avatars.githubusercontent.com"}),[e?.sso_organizations,e?.base_avatar_url])}},79988:(e,n,t)=>{t.d(n,{c$:()=>i,n5:()=>r,z4:()=>s});let i="global_sso_banner",r=3,s="dismissed_sso_orgs"}}]);
//# sourceMappingURL=packages_global-sso-banner_GlobalSsoBanner_tsx-a6fe2c9e4e5a.js.map